<?xml version="1.0"?>

<!-- ======================================================== -->
<!--                 WOLips Ant file.                         -->
<!-- ======================================================== -->
<project name="woproject-wolips-dist" default="dist" basedir=".">

   <target name="dist">
    <!-- make feature -->
    <mkdir dir="${wolips.feature.dist}"/>
    <copy todir="${wolips.feature.dist}">
        <fileset dir="src/wolips-feature">
        	<exclude name=".project"/>
        </fileset>
    </copy>
    <copy todir="${wolips.feature.dist}">
        <fileset dir="doc">
        	<include name="LICENSE"/>
        </fileset>
    </copy>
    <copy todir="${wolips.feature.dist}">
        <fileset dir="src/wolips/icons/wolips">
        	<include name="WOLips-medium.gif"/>
        </fileset>
    </copy>
     <jar jarfile="${wolips.feature.dist}.jar">
     	<fileset dir="${wolips.feature.dist}">
     	</fileset>
     </jar>


 <!-- make feature -->
    <mkdir dir="${wolips.feature.plugin.dist}"/>
    <copy todir="${wolips.feature.plugin.dist}">
        <fileset dir="src/wolips-feature-plugin">
        	<exclude name=".project"/>
        </fileset>
    </copy>
    <copy todir="${wolips.feature.plugin.dist}">
        <fileset dir="doc">
        	<include name="LICENSE"/>
        </fileset>
    </copy>
    <jar jarfile="${wolips.feature.plugin.dist}.jar">
     	<fileset dir="${wolips.feature.plugin.dist}">
     	</fileset>
     </jar>


    <mkdir dir="${wolips.profiling.feature.dist}"/>
    <copy todir="${wolips.profiling.feature.dist}">
        <fileset dir="src/wolips-profiling-feature">
        	<exclude name=".project"/>
        </fileset>
    </copy>
    <copy todir="${wolips.profiling.feature.dist}">
        <fileset dir="doc">
        	<include name="LICENSE"/>
        </fileset>
    </copy>
    <copy todir="${wolips.profiling.feature.dist}">
        <fileset dir="src/wolips/icons/wolips">
        	<include name="WOLips-medium.gif"/>
        </fileset>
    </copy>
     <jar jarfile="${wolips.profiling.feature.dist}.jar">
     	<fileset dir="${wolips.profiling.feature.dist}">
     	</fileset>
     </jar>
 
    <mkdir dir="${wolips.tests.feature.dist}"/>
    <copy todir="${wolips.tests.feature.dist}">
        <fileset dir="src/wolips-tests-feature">
        	<exclude name=".project"/>
        </fileset>
    </copy>
    <copy todir="${wolips.tests.feature.dist}">
        <fileset dir="doc">
        	<include name="LICENSE"/>
        </fileset>
    </copy>
    <copy todir="${wolips.tests.feature.dist}">
        <fileset dir="src/wolips/icons/wolips">
        	<include name="WOLips-medium.gif"/>
        </fileset>
    </copy>
     <jar jarfile="${wolips.tests.feature.dist}.jar">
     	<fileset dir="${wolips.tests.feature.dist}">
     	</fileset>
     </jar>

	<!-- copy optional stuff -->
    <mkdir dir="${wolips.dist.base}/optional"/>
    <copy todir="${wolips.dist.base}/optional">
        <fileset dir="optional">
        </fileset>
	</copy>


     <copy todir="${wolips.dist.base}">
        <fileset dir="doc/update/local">
        	<include name="site.xml"/>
        </fileset>
    </copy>
     
    <!-- make wolips dist -->
    <tar tarfile="${wolips.dist.filename}.tar">
        <tarfileset dir="${wolips.dist.base}">
        <include name="**/plugins/*.jar"/>
        <include name="**/features/*.jar"/>
		<include name="README.html"/>
		<include name="site.xml"/>
		<include name="about.html"/>
		<include name="optional/**"/>		
	</tarfileset>
     </tar>
         
     <gzip src="${wolips.dist.filename}.tar"
         zipfile="${wolips.dist.filename}.tar.gz"/>
     <delete file="${wolips.dist.filename}.tar"/>

     <tar tarfile="${wolips.dist.base}/org.eclipse.core.ant.patched.tar">
         <tarfileset dir="${wolips.dist.base}">
             <include name="**/optional/**"/>
         </tarfileset>
    </tar>

   <gzip src="${wolips.dist.base}/org.eclipse.core.ant.patched.tar"
       zipfile="${wolips.dist.base}/org.eclipse.core.ant.patched.tar.gz"/>	
   <delete file="${wolips.dist.base}/org.eclipse.core.ant.patched.tar"/>

   </target>

</project>
