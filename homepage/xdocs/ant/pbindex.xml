<?xml version="1.0"?>
<document>
    <title>PBIndex Task Manual</title>

    <body>
 		<section name="PBIndex Task Manual">
			<h3>Description:</h3>

			<p><code>PBIndex</code> is an Ant task to maintain a ProjectBuilderWO PB.project
			file. This file is needed even when ProjectBuilderWO is not used, since other
			WebObjects tools, like WebObjectsBuilder, use it to obtain the information
			about the project.</p>
			
			<p>PBIndex should be run after adding or removing classes, WOComponents and resources
			to/from the project to make WOBuilder aware of such changes. Another possible use of 
			PBIndex is to avoid PB.project merge problems when changes are done to the 
			project simultaneously by multiple developers. It should also be helpful when developing
			in an environment where ProjectBuilderWO is used together with other IDE's.			
			</p>

			<h3>Parameters:</h3>

			<table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Attribute</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Required</b></th>
				</tr>
				<tr>
					<td valign="top">name</td>
					<td valign="top">Name of the framework or application project.</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">projectFile</td>
					<td valign="top">PB.project file location. When 
					ommitted, <code>PB.project</code> file in the current directory is
					assumed. If the file at the specified location does not exist, it is 
					created using internal template.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">framework</td>
					<td valign="top">Boolean value that defines whether the target project is an application
					or a framework. Default is <code>false</code> (application).</td>
					<td valign="top" align="center">No</td>
				</tr>
			</table>

			<h3>Nested elements:</h3>

			<h4>src</h4>
			<p>The nested <code>src</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>
			matching Java source files used in the project. Note that only <code>*.java</code>
			files will be included out of all the files matched.</p>

			<h4>resources</h4>
			<p>The nested <code>resources</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>
			matching a set of project resources, such as <code>.api</code> files. (Note: do not include 
			WOComponents in this list.)</p>

			<h4>wsresources</h4>
			<p>The nested <code>wsresources</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a> 
			matching all web server resources used in the project, such as images, CSS, etc.</p>
			
			<h4>wocomponents</h4>
			<p>The nested <code>wocomponents</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a> 
			matching all WOComponents used in the project. Note that only <code>*.wo</code>
			directories will be included out of all the files and directories matched.</p>
			
            <h4>frameworks</h4>
			<p>The nested <code>frameworks</code> is a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>
			structure that specifies the names of the
            WebObjects Frameworks that this application is dependant upon. This allows
            WebObjects Builder to discover and make use of components in reusable
            frameworks.</p>
            
			<h4>Nested <code>frameworks</code> Parameters: </h4>
			<p><i>Note: all standard FileSet 
			parameters are supported as well, though <code>dir</code>
			wouldn't make sense and will be ignored.</i></p>
            <table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Attribute</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Required</b></th>
				</tr>
				<tr>
					<td valign="top">root</td>
					<td valign="top">Logical base location of the framework. Allowed values are 
					"wo.homeroot", "wo.wosystemroot", "wo.localroot" (these are string values,
					don't include them in <code>${}</code>)</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">if</td>
					<td valign="top">The name if a property that decides if the framework set is included. 
					This is a string value, don't include them in <code>${}</code>. You can then set the property to include the framework or leave it undefined to leave it out.</td>
					<td valign="top" align="center">Not applicable, leave it out when you want to include the framework by default.</td>
				</tr>
			</table>

			<h4>Examples:</h4>

<p>Framework indexing, assuming that PB.project is located in the directory
where the task is run. If PB.project does not exist, it is automatically created:
</p>

<source>
&amp;lt;taskdef name="pbindex" classname="org.objectstyle.woproject.ant.PBIndex"&amp;gt;
     &amp;lt;classpath refid="classpath"/&amp;gt;
&amp;lt;/taskdef&amp;gt;
&amp;lt;pbindex name="MyFramework"&amp;gt;
   &amp;lt;src dir="java"&amp;gt;
      &amp;lt;exclude name="*.properties"/&amp;gt;
   &amp;lt;/src&amp;gt;
   
   &amp;lt;resources dir="."&amp;gt;
       &amp;lt;include name="*.eomodeld"/&amp;gt;
       &amp;lt;include name="*.api"/&amp;gt;
   &amp;lt;/resources&amp;gt;
   
   &amp;lt;wsresources dir="."&amp;gt;
       &amp;lt;!-- Include the whole Images folder as a single resource --&amp;gt;
       &amp;lt;include name="Images"/&amp;gt;
   &amp;lt;/wsresources&amp;gt;
   
   &amp;lt;wocomponents dir="."&amp;gt;
       &amp;lt;include name="*.wo"/&amp;gt;
   &amp;lt;/wocomponents&amp;gt;
&amp;lt;/pbindex&amp;gt;
</source>

<p>You can also define <code>frameworks</code> once outside <code>PBIndex</code>
and reference them from <code>PBIndex</code>, <a href="wocompile.html">WOCompile</a>,
<a href="woapplication.html">WOApplication</a> and <a href="pbxindex.html">PBXIndex</a>:
</p>

<source>
&amp;lt;typedef name="frameworks" classname="org.objectstyle.woproject.ant.FrameworkSet"/&amp;gt;
&amp;lt;frameworks root=".." id="developer.frameworks" embed="true"&amp;gt;
    &amp;lt;include name="MyFramework/out/MyFramework.framework"/&amp;gt;
&amp;lt;/frameworks&amp;gt;

&amp;lt;target name="build"&amp;gt;
    &amp;lt;taskdef name="pbindex" classname="org.objectstyle.woproject.ant.PBIndex"/&amp;gt;
    &amp;lt;pbindex name="Spike" projectFile="./PB.project"&amp;gt;
        &amp;lt;src dir="."&amp;gt;
            &amp;lt;include name="src/**/*.java"/&amp;gt;
        &amp;lt;/src&amp;gt;
        &amp;lt;resources dir="."&amp;gt;
            &amp;lt;include name="*.eomodeld"/&amp;gt;
            &amp;lt;include name="*.api"/&amp;gt;
        &amp;lt;/resources&amp;gt;
        &amp;lt;wocomponents dir="."&amp;gt;
            &amp;lt;include name="*.wo"/&amp;gt;
        &amp;lt;/wocomponents&amp;gt;
        &amp;lt;frameworks refid="developer.frameworks"/&amp;gt;
    &amp;lt;/pbindex&amp;gt;
    
    &amp;lt;taskdef name="pbxindex" classname="org.objectstyle.woproject.ant.PBXIndex"/&amp;gt;
    &amp;lt;pbxindex projectFile="./PBX.pbproj"&amp;gt;
        &amp;lt;resources dir="."&amp;gt;
            &amp;lt;include name="*.eomodeld"/&amp;gt;
        &amp;lt;/resources&amp;gt;
        &amp;lt;frameworks refid="developer.frameworks"/&amp;gt;
    &amp;lt;/pbxindex&amp;gt;
&amp;lt;/target&amp;gt;
</source>
    	</section>
    </body>
</document>
