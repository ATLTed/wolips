<?xml version="1.0"?>
 
<!-- ======================================================== -->
<!--        Main WOLips plugins Ant build file                -->
<!-- Serves as a facade for different helper build files.     -->
<!-- ======================================================== -->
<project name="wolips" default="" basedir=".">

    <!-- ========================================== -->
    <!-- Verify test.eclipse.home.                  -->
    <!-- ========================================== -->
    <target name="verify">
        <condition property="test.eclipse.home.set">
            <isset property="test.eclipse.home"/>
        </condition>
        <condition property="test.eclipse.home.not.set">
            <not>
                <isset property="test.eclipse.home"/>
            </not>
        </condition>
        <condition property="os.set">
            <isset property="os"/>
        </condition>
        <condition property="os.not.set">
            <not>
                <isset property="os"/>
            </not>
        </condition>
        <condition property="ws.set">
            <isset property="ws"/>
        </condition>
        <condition property="ws.not.set">
            <not>
                <isset property="ws"/>
            </not>
        </condition>
        <condition property="test.java.library.path.set">
            <isset property="test.java.library.path"/>
        </condition>
        <condition property="test.java.library.path.not.set">
            <not>
                <isset property="test.java.library.path"/>
            </not>
        </condition>
        <condition property="test.properties.set">
            <and>
                <isset property="test.eclipse.home"/>
                <isset property="os"/>
                <isset property="ws"/>
                <isset property="test.java.library.path"/>
            </and>
        </condition>
    </target>

    <!-- ========================================== -->
    <!-- Inform user.                               -->
    <!-- ========================================== -->
    <target name="inform_user" if="test.eclipse.home.not.set">
        <echo message="Please set the property test.eclipse.home in your build.properties to run wolips unit tests." />
   </target>

    <!-- ========================================== -->
    <!-- Inform user.                               -->
    <!-- ========================================== -->
    <target name="inform_user_os" if="os.not.set">
        <echo message="Please set the property os in your build.properties to run wolips unit tests."/>
    </target>

    <!-- ========================================== -->
    <!-- Inform user.                               -->
    <!-- ========================================== -->
    <target name="inform_user_ws" if="ws.not.set">
        <echo message="Please set the property ws in your build.properties to run wolips unit tests."/>
    </target>

    <!-- ========================================== -->
    <!-- Inform user.                               -->
    <!-- ========================================== -->
    <target name="inform_user_test_java_library_path" if="test.java.library.path.not.set">
        <echo message="Please set the property test.java.library.path in your build.properties to run wolips unit tests."/>
    </target>

    <!-- ========================================== -->
    <!-- Build all.                                 -->
    <!-- ========================================== -->
    <target name="all">
	<ant dir="org.objectstyle.wolips.logging" target="all"/>
	<ant dir="org.objectstyle.wolips" target="all"/>
	<ant dir="org.objectstyle.wolips.help" target="all"/>
	<ant dir="org.objectstyle.wolips.targetbuilder" target="all"/>
	<ant dir="org.objectstyle.wolips.support" target="all"/>
	<ant dir="org.objectstyle.wolips.launching" target="all"/>
	<ant dir="org.objectstyle.wolips.profiling" target="all"/>
	<ant dir="org.objectstyle.wolips.devstudio" target="all"/>
	<ant dir="org.objectstyle.wolips.projectbuild" target="all"/>
	<ant dir="org.objectstyle.wolips.tests" target="all"/>
	<ant dir="org.objectstyle.wolips.wounit" target="all"/>
	<ant dir="org.objectstyle.wolips.ui" target="all"/>
	<ant dir="org.objectstyle.wolips.wizards" target="all"/>
	<ant dir="org.objectstyle.wolips.source" target="all"/>
	<ant dir="org.objectstyle.wolips.woproject" target="all"/>
	<ant dir="org.objectstyle.wolips.woproject.ant" target="all"/>
	<ant dir="org.objectstyle.wolips.cayenne" target="all"/>
	<ant dir="org.objectstyle.wolips.cayenne.ant" target="all"/>
	<ant dir="org.objectstyle.wolips.team" target="all"/>
	<ant dir="org.objectstyle.wolips.ant" target="all"/>
	<ant dir="org.objectstyle.wolips.feature" target="all"/>
    </target>
    <!-- ========================================== -->
    <!-- Build dist.                                -->
    <!-- ========================================== -->
    <target name="dist">
	<ant dir="org.objectstyle.wolips.logging" target="dist"/>
	<ant dir="org.objectstyle.wolips" target="dist"/>
	<ant dir="org.objectstyle.wolips.help" target="dist"/>
	<ant dir="org.objectstyle.wolips.targetbuilder" target="dist"/>
	<ant dir="org.objectstyle.wolips.support" target="dist"/>
	<ant dir="org.objectstyle.wolips.launching" target="dist"/>
	<ant dir="org.objectstyle.wolips.profiling" target="dist"/>
	<ant dir="org.objectstyle.wolips.devstudio" target="dist"/>
	<ant dir="org.objectstyle.wolips.projectbuild" target="dist"/>
	<ant dir="org.objectstyle.wolips.tests" target="dist"/>
	<ant dir="org.objectstyle.wolips.wounit" target="dist"/>
	<ant dir="org.objectstyle.wolips.ui" target="dist"/>
	<ant dir="org.objectstyle.wolips.wizards" target="dist"/>
	<ant dir="org.objectstyle.wolips.source" target="dist"/>
	<ant dir="org.objectstyle.wolips.woproject" target="dist"/>
	<ant dir="org.objectstyle.wolips.woproject.ant" target="dist"/>
	<ant dir="org.objectstyle.wolips.cayenne" target="dist"/>
	<ant dir="org.objectstyle.wolips.cayenne.ant" target="dist"/>
	<ant dir="org.objectstyle.wolips.team" target="dist"/>
	<ant dir="org.objectstyle.wolips.ant" target="dist"/>
	<ant dir="org.objectstyle.wolips.feature" target="dist"/>
    </target>

    <!-- ========================================== -->
    <!-- Build test prepare.                        -->
    <!-- ========================================== -->
    <target name="test.prepare" if="test.eclipse.home.set">
        <copy todir="${test.eclipse.home}/plugins">
            <fileset dir="../../${build.output.build.dir}/plugins">
          	</fileset>
         </copy> 
	    <copy todir="${test.eclipse.home}/features">
            <fileset dir="../../${build.output.build.dir}/features">
          	</fileset>
         </copy> 
    </target>

    <!-- ========================================== -->
    <!-- Build test run.                            -->
    <!-- ========================================== -->
    <target name="test.run" if="test.properties.set">
	    <ant dir="org.objectstyle.wolips.tests" target="test">
	        <property name="param.eclipse.home" value="${test.eclipse.home}"/>
	    </ant>
    </target>

    <!-- ========================================== -->
    <!-- Build test.                                -->
    <!-- ========================================== -->
    <target name="test" depends="verify,inform_user,inform_user_os,inform_user_ws,inform_user_test_java_library_path,test.prepare,test.run">
	</target>

</project>
