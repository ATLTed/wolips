<?xml version="1.0"?>
<document>
    <title>WOApplication Task Manual</title>

    <properties>
        <author>Andrei Adamchik, Emily Bache</author>
    </properties>

    <body>
 		<section name="WOApplication Task Manual">
			<h3>Description:</h3>

			<p><code>WOApplication</code> is an Ant task to build WebObjects
			applications from a set of files. It does not enforce any particular project structure
			and can be used to create applications without using the ProjectBuilder or XCode.
			</p>
			
			<h3>Properties:</h3>
			
			<p>WOApplication behavior depends on various properties in the wobuild.properties file that specify
			common locations of the frameworks used by the application. 
			These properties can be initialized with the ant script woproperties.xml.
			Per default the woapplication task expects this file in $user.home/Library/wobuild.properties.
			If no file is found the woapplication task resolves the property WOBUILD_PROPERTIES from the
			java properties and the environment(in this order) to find the file.</p>
			
			<table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Property from the wobuild.properties file</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Default</b></th>
				</tr>
				<tr>
					<td valign="top">wo.wosystemroot</td>
					<td valign="top">Usually this is a WebObjects installation directory,
					like "C:\Apple".</td>
					<td valign="top" align="center">NEXT_ROOT environment variable, or root directory "/".</td>
				</tr>
				<tr>
					<td valign="top">wo.localroot</td>
					<td valign="top">Usually this is a "Local" directory
					under the directory specified by "wo.woroot".</td>
					<td valign="top" align="center">${wo.woroot}/Local</td>
				</tr>
				<tr>
					<td valign="top">wo.homeroot</td>
					<td valign="top">Usually this is a user home directory.</td>
					<td valign="top" align="center">${user.home}</td>
				</tr>
			</table>

			<h3>Parameters:</h3>

			<table border="1" cellpadding="2" cellspacing="0">
				<tr>
					<th valign="top"><b>Attribute</b></th>
					<th valign="top"><b>Description</b></th>
					<th align="center" valign="top"><b>Required</b></th>
				</tr>
				<tr>
					<td valign="top">name</td>
					<td valign="top">Name of the application (without <i>.woa</i> extension).</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">chmod</td>
					<td valign="top">Optional value for the chmod command executed by the
					WOApplication task. The default is "gu+x". The chmod command is only
					executed on the first build of the application and only on "Unix" platforms. The default is "750".</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">destDir</td>
					<td valign="top">Destination directory where the application woa should be created.</td>
					<td valign="top" align="center">Yes</td>
				</tr>
				<tr>
					<td valign="top">wsDestDir</td>
					<td valign="top">Destination directory where WebServerResorces should be copied 
					during split install (presense of this parameter will trigger split install). WebServerResources
					will be created under [wsDestDir]/WebObjects/AppName.woa/Contents/.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">principalClass</td>
					<td valign="top">Subclass of <code>WOApplication</code> to use.</td>
					<td valign="top" align="center">Application</td>
				</tr>
				<tr>
					<td valign="top">customInfoPListContent</td>
					<td valign="top">String to append to the Info.plist.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">stdFrameworks</td>
					<td valign="top">If set to <i>true</i>, a set of standard frameworks will be 
					associated with the deployed application (default is <i>true</i>). "Standard"
					frameworks are: JavaWebObjects, JavaWOExtensions, JavaEOAccess, JavaEOControl,
					JavaFoundation, JavaJDBCAdaptor, JavaXML.</td>
					<td valign="top" align="center">No</td>
				</tr>
				<tr>
					<td valign="top">jvmOptions</td>
					<td valign="top">String for the JVM options in the classpath.</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML</td>
					<td valign="top">Generate web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_WOROOT</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_LOCALROOT</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_WOAINSTALLROOT</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_WOAppMode</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_WOtaglib</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
				<tr>
					<td valign="top">webXML_CustomContent</td>
					<td valign="top">Optional parameter for the web.xml</td>
					<td valign="top" align="center">NO</td>
				</tr>
			</table>

			<h3>Nested elements:</h3>

			<h4>classes</h4>
			<p>The nested <code>classes</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			All files included in this fileset will end up in the 
			<code>Contents/Resources/Java/*.jar</code> file of the application.</p>

			<h4>sources</h4>
			<p>The optional nested <code>sources</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			All files included in this fileset will
			end up in the <code>Resources/Java/src.jar</code> file of the framework. <br />
			This is useful when debugging with WOLips.</p>

			<h4>resources</h4>
			<p>The nested <code>resources</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			All files included in this fileset will
			end up in the <code>Contents/Resources</code> directory of the application. 
			For the discussion
			of resource localization issues follow <a href="localized.html">this link</a>.</p>

			<h4>wsresources</h4>
			<p>The nested <code>wsresources</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			All files included in this fileset will
			end up in the <code>Contents/WebServerResources</code> directory of the application.
			For the discussion
			of resource localization issues follow <a href="localized.html">this link</a>.</p>

            <h4>flattenfiles</h4>
			<p>The nested <code>flattenfiles</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			All files included in this fileset will be loaded.
			The content of a file should be a list of carriage return separated pattern.
			If a pattern is matched for a given resource or wsresource the file will be flatened.</p>

            <h4>frameworks</h4>
			<p>The nested <code>frameworks</code> is a <a
			href="frameworkset.html">FrameworkSet</a>
			structure that specifies the names of the
            WebObjects Frameworks that this application is dependant upon. The jar files from
            these frameworks will be referenced in varios platform-specific depoyment files 
            (such as CLASSPATH.TXT), and specified in the web.xml classpath if an application 
            is deployed as a servlet. When building a FileSet, path should match up to the 
            "*.framework" directory (no need to match individual JAR files).</p>
            
            <h4>lib</h4>
			<p>The nested <code>lib</code> element specifies a <a
			href="http://jakarta.apache.org/ant/manual/CoreTypes/fileset.html">FileSet</a>.
			This should be a fileset of jar libraries required by your application. All files
            in this fileset will end up in the <code>Resources/Java</code> folder of the application,
            and will be included on the classpath for this application.</p>

			
			<h3>Examples:</h3>

			<p>Create an application "MyApp" with a set of standard frameworks:</p>
<source>
&amp;lt;taskdef name="woapplication" classname="org.objectstyle.woproject.ant.WOApplication"&amp;gt;
     &amp;lt;classpath refid="classpath"/&amp;gt;
&amp;lt;/taskdef&amp;gt;

&amp;lt;woapplication name="MyApp" destDir="${dist}/WebObjects/Applications"&amp;gt;
   &amp;lt;classes dir="${build}/common"&amp;gt;
      &amp;lt;exclude name="*.properties"/&amp;gt;
   &amp;lt;/classes&amp;gt;
   &amp;lt;classes dir="${build}/business"&amp;gt;
       &amp;lt;exclude name="*.properties"/&amp;gt;
   &amp;lt;/classes&amp;gt;
   &amp;lt;resources dir="src/resources"&amp;gt;
       &amp;lt;include name="*.eomodeld/**"/&amp;gt;
       &amp;lt;include name="*.wo/**"/&amp;gt;
   &amp;lt;/resources&amp;gt;
   &amp;lt;wsresources dir="src/frameworks/WSResources"&amp;gt;
       &amp;lt;include name="Images/**"/&amp;gt;
   &amp;lt;/wsresources&amp;gt;
&amp;lt;/woapplication&amp;gt;
</source>


			<p>Create an application "MyApp" with no implicit standard frameworks
			and a set of custom frameworks located under HOMEROOT (defined from the 
			value of <code>wo.homeroot</code> property):</p>
<source>
&amp;lt;woapplication name="MyApp" stdFrameworks="false" destDir="${dist}/WebObjects/Applications"&amp;gt;
   ...
   &amp;lt;frameworks dir="../Frameworks"&amp;gt;
      &amp;lt;include name="**/*.framework"/&amp;gt;
   &amp;lt;/frameworks&amp;gt;
&amp;lt;/woapplication&amp;gt;
</source>
    	</section>
    </body>
</document>
